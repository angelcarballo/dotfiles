#!/bin/bash

# Load tmux-status-variables
PLUGIN_DIR=$(tmux show-option -gqv "@status_variables_dir")
source "$PLUGIN_DIR/utils/sdk.sh"

on_cache_miss() {
  EVENT=`gcalcli --locale en_US --nostarted --calendar "" agenda --nocolor | cut -d " " -f 4- | head -2 | tail -1 | sed "s/^ *//g" | sed "s/    / /g" | cut -c1-60`
  if [ -z "$EVENT" ]
  then
    echo "No events today"
  else
    echo $EVENT
  fi
}


echo "$(get_cached_value on_cache_miss)"
